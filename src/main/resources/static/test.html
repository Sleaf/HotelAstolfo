<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我的阿福</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/management.css">
</head>
<body>
<div class="top_banner">

</div>
<div class="main">
    <div class="left-nav untouchable"></div>
    <div class="container">
        <div id="modify_rooms_type">
            <div><h4>房间类型管理</h4>
                <table class="type">
                    <tr>
                        <td>类型名称</td>
                        <td>房间描述</td>
                        <td></td>
                    </tr>
                    <tr v-for="room in types" v-cloak>
                        <td>{{room.type}}</td>
                        <td>{{room.description}}</td>
                        <td>
                            <div class="confirm btn btn-default" :id="room.type" @click="delType">删除</div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="text" id="newType" title="新客房类型" placeholder="新客房类型"></td>
                        <td><input type="text" id="newTypeDes" title="新客房类型描述" placeholder="新客房类型描述"></td>
                        <td>
                            <div class="btn btn-default confirm" @click="addType">添加</div>
                        </td>
                    </tr>
                </table>
            </div>
            <div><h4>房间朝向管理</h4>
                <table class="direction">
                    <tr>
                        <td>朝向名称</td>
                        <td>朝向描述</td>
                        <td></td>
                    </tr>
                    <tr v-for="direction in directions" v-cloak>
                        <td>{{direction.type}}</td>
                        <td>{{direction.description}}</td>
                        <td>
                            <div class="confirm btn btn-default" :id="direction.type" @click="delDir">删除</div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="text" id="newDir" title="新朝向名称" placeholder="新朝向名称"></td>
                        <td><input type="text" id="newDirDes" title="新朝向描述" placeholder="新朝向描述"></td>
                        <td>
                            <div class="btn btn-default confirm" @click="addDir">添加</div>
                        </td>
                    </tr>
                </table>
            </div>
            <div><h4>可用客房管理</h4>
                <table class="room">
                    <tr>
                        <td>楼层</td>
                        <td>房号</td>
                        <td>朝向</td>
                        <td>房间类型</td>
                        <td>特色</td>
                        <td>价格</td>
                        <td>是否有损坏</td>
                        <td><!--操作--></td>
                    </tr>
                    <tr v-for="room in rooms" v-cloak>
                        <td>{{room.roomNumber.floor}}</td>
                        <td>{{room.roomNumber.number}}</td>
                        <td :title="room.direction.description">{{room.direction.type}}</td>
                        <td :title="room.type.description">{{room.type.type}}</td>
                        <td>{{room.specialty}}</td>
                        <td>{{room.price}}</td>
                        <td>{{broken(room.broken)}}</td>
                        <td>
                            <div class="confirm btn btn-default" :id="room.id" @click="delRoom">删除</div>
                        </td>
                    </tr>
                    <tr>
                        <td><input type="number" id="newRFloor" title="开放新房间楼层" placeholder="开放新房间楼层"></td>
                        <td><input type="number" id="newRNum" title="开放新房间房号" placeholder="开放新房间房号"></td>
                        <td>
                            <select id="newRDir" title="开放新房间朝向">
                                <option v-for="edirection in directions" :value="edirection" v-cloak>
                                    {{edirection.type}}
                                </option>
                            </select>
                        </td>
                        <td>
                            <select id="newRType" title="开放新房间类型">
                                <option v-for="etype in types" :value="etype" v-cloak>{{etype.type}}</option>
                            </select>
                        </td>
                        <td><input type="text" id="newRSpecial" title="开放新房间特色" placeholder="开放新房间特色"></td>
                        <td><input type="number" min="0" max="999999" id="newRPrice" title="开放新房间价格"
                                   placeholder="新房间价格"></td>
                        <td><select id="newRBroken" title="开放新房间是否损坏">
                            <option value="true">有</option>
                            <option value="false" selected>无</option>
                        </select>
                        </td>
                        <td>
                            <div class="btn btn-default confirm" @click="addRoom">添加</div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="footer">
</div>
<script src="js/vue.js"></script>
<script src="js/jquery-3.2.1.js"></script>
<script src="js/tools.js"></script>
<script>
    let data = {
        "types": [
            {
                "id": 3,
                "type": "东",
                "description": "冬暖夏狼"
            },
            {
                "id": 4,
                "type": "东2",
                "description": "冬暖夏狼"
            },
            {
                "id": 5,
                "type": "大床房",
                "description": "冬暖夏狼"
            }
        ],
        "directions": [
            {
                "id": 1,
                "type": "东2",
                "description": "冬暖夏狼"
            },
            {
                "id": 2,
                "type": "东",
                "description": "冬暖夏狼"
            }
        ],
        "rooms": [
            {
                "id": 6,
                "roomNumber": {
                    "floor": 5,
                    "number": 1
                },
                "type": {
                    "id": 5,
                    "type": "大床房",
                    "description": "冬暖夏狼"
                },
                "direction": {
                    "id": 2,
                    "type": "东",
                    "description": "冬暖夏狼"
                },
                "specialty": "一个介绍",
                "price": 143,
                "broken": false
            },
            {
                "id": 7,
                "roomNumber": {
                    "floor": 2,
                    "number": 1
                },
                "type": {
                    "id": 5,
                    "type": "大床房",
                    "description": "冬暖夏狼"
                },
                "direction": {
                    "id": 2,
                    "type": "东",
                    "description": "冬暖夏狼"
                },
                "specialty": "一个介绍",
                "price": 143,
                "broken": false
            },
            {
                "id": 8,
                "roomNumber": {
                    "floor": 3,
                    "number": 1
                },
                "type": {
                    "id": 5,
                    "type": "大床房",
                    "description": "冬暖夏狼"
                },
                "direction": {
                    "id": 2,
                    "type": "东",
                    "description": "冬暖夏狼"
                },
                "specialty": "一个介绍",
                "price": 143,
                "broken": false
            }
        ]
    };
    let app = new Vue({
        el: '#modify_rooms_type',
        data: {
            types: data.types,
            directions: data.directions,
            rooms: data.rooms
        },
        methods: {
            addRoom: function () {
                startCatLoading();
                //TODO
                $.ajax({
                    url: `${serverHost}/api/rooms/types`,
                    type: 'POST',
                    dataType: 'json',
                    contentType: "application/json; charset=UTF-8",
                    data: {},
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader("Authorization", "Basic " + btoa(sessionStorage.username || localStorage.username + ":" + sessionStorage.password || localStorage.password));
                    },
                    success: function (data, textStatus, jqXHR) {
                        showMsg('添加成功！')
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        showMsg('添加失败！',jqXHR.status);
                    },
                    complete: function () {
                        stopCatLoading();
                    }
                });
            },
            delRoom: function () {
                //TODO
                //等待接口
            },
            addDir: function () {
                startCatLoading();
                //TODO
                $.ajax({
                    url: `${serverHost}/api/rooms/directions`,
                    type: 'POST',
                    dataType: 'json',
                    contentType: "application/json; charset=UTF-8",
                    data: {},
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader("Authorization", "Basic " + btoa(sessionStorage.username || localStorage.username + ":" + sessionStorage.password || localStorage.password));
                    },
                    success: function (data, textStatus, jqXHR) {
                        showMsg('添加成功！');
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        showMsg('添加失败！',jqXHR.status);
                    },
                    complete: function () {
                        stopCatLoading();
                    }
                });
            },
            delDir: function () {
                //TODO
                //等待接口
            },
            addType: function () {
                startCatLoading();
                //TODO
                $.ajax({
                    url: `${serverHost}/api/rooms`,
                    type: 'POST',
                    dataType: 'json',
                    contentType: "application/json; charset=UTF-8",
                    data: {},
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader("Authorization", "Basic " + btoa(sessionStorage.username || localStorage.username + ":" + sessionStorage.password || localStorage.password));
                    },
                    success: function (data, textStatus, jqXHR) {
                        showMsg('添加成功！')
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        showMsg('添加失败！',jqXHR.status);
                    },
                    complete: function () {
                        stopCatLoading();
                    }
                });
            },
            delType: function () {
                //TODO
                //等待接口
            },
            broken: function (isBroken) {
                return isBroken ? '需维修' : '无需维修';
            }
        }
    })
</script>
</body>
</html>